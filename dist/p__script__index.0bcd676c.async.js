(self.webpackChunk=self.webpackChunk||[]).push([[4756],{87183:function(le){le.exports={"left-tree-container":"left-tree-container___3ivV3","left-tree-scroller":"left-tree-scroller___r-ES6","log-container":"log-container___2Beqi"}},82539:function(le,I,e){"use strict";e.r(I);var He=e(97244),G=e(77690),$e=e(95644),_e=e(78986),Je=e(11394),H=e(92920),ce=e(30606),$=e(65509),T=e(91795),K=e(70307),Qe=e(27579),d=e(55348),de=e(22205),J=e.n(de),R=e(12924),m=e.n(R),me=e(76225),p=e(6429),ve=d.Z.Option,W=s=>{var f=s.handleCancel,De=s.treeData,Q=s.visible,_=T.Z.useForm(),t=(0,K.Z)(_,1),v=t[0],re=(0,R.useState)(!1),X=(0,K.Z)(re,2),h=X[0],F=X[1],g=(0,R.useState)([]),Y=(0,K.Z)(g,2),A=Y[0],se=Y[1],U=function(){var o=(0,ce.Z)(J().mark(function C(E){return J().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:F(!0),E.path=E.path||"",me.W.post("".concat(p.Z.apiPrefix,"scripts"),{data:{filename:E.filename,path:E.path,content:""}}).then(w=>{var oe=w.code,q=w.data;oe===200?(H.ZP.success("\u4FDD\u5B58\u6587\u4EF6\u6210\u529F"),f({filename:E.filename,path:E.path,key:"".concat(E.path,"-").concat(E.filename)})):H.ZP.error(q),F(!1)}).finally(()=>F(!1));case 3:case"end":return x.stop()}},C)}));return function(E){return o.apply(this,arguments)}}();return(0,R.useEffect)(()=>{v.resetFields();var o=De.filter(C=>C.disabled);se([{key:""},...o])},[Q]),m().createElement(G.Z,{title:"\u65B0\u5EFA\u6587\u4EF6",visible:Q,forceRender:!0,centered:!0,maskClosable:!1,onOk:()=>{v.validateFields().then(o=>{U(o)}).catch(o=>{console.log("Validate Failed:",o)})},onCancel:()=>f(),confirmLoading:h},m().createElement(T.Z,{form:v,layout:"vertical",name:"edit_name_modal"},m().createElement(T.Z.Item,{name:"filename",label:"\u6587\u4EF6\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D"}]},m().createElement(_e.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D"})),m().createElement(T.Z.Item,{label:"\u7236\u76EE\u5F55",name:"path",initialValue:A&&A.length>0?A[0].key:""},m().createElement(d.Z,{placeholder:"\u8BF7\u9009\u62E9\u7236\u76EE\u5F55"},A.map(o=>m().createElement(ve,{value:o.key},o.key||"\u6839"))))))};I.default=W},13472:function(le,I,e){"use strict";e.r(I);var He=e(40844),G=e(45710),$e=e(19255),_e=e(45512),Je=e(95644),H=e(78986),ce=e(36748),$=e(71864),T=e(93536),K=e(92479),Qe=e(33036),d=e(46009),de=e(62767),J=e(58257),R=e(38645),m=e(38313),me=e(11394),p=e(92920),ve=e(97244),W=e(77690),s=e(70307),f=e(18158),De=e(65570),Q=e(51907),_=e(12924),t=e.n(_),v=e(6429),re=e(23910),X=e(1858),h=e(76225),F=e(87183),g=e.n(F),Y=e(54411),A=e(27768),se=e(30498),U=e(48487),o=e(36531),C=e(27478),E=e(77062),Pe=e(82539),x=e(66292),w=e.n(x),oe=e(42954),q=Q.Z.Text;function Me(D,ee){var P=[];if(D){var V=[];return ee.forEach(y=>{if(y.title.toLocaleLowerCase().includes(D))V.push(y);else{var b=[];(y.children||[]).forEach(k=>{k.title.toLocaleLowerCase().includes(D)&&b.push(k)}),b.length>0&&(V.push((0,f.Z)((0,f.Z)({},y),{},{children:b})),P.push(y.key))}}),{tree:V,expandedKeys:P}}return{tree:ee,expandedKeys:P}}var Xe={".py":"python",".js":"javascript",".sh":"shell",".ts":"typescript"},Ye=D=>{var ee=D.headerStyle,P=D.isPhone,V=D.theme,y=D.socketMessage,b=(0,_.useState)("\u8BF7\u9009\u62E9\u811A\u672C\u6587\u4EF6"),k=(0,s.Z)(b,2),we=k[0],Oe=k[1],qe=(0,_.useState)("\u8BF7\u9009\u62E9\u811A\u672C\u6587\u4EF6"),fe=(0,s.Z)(qe,2),B=fe[0],L=fe[1],et=(0,_.useState)(),he=(0,s.Z)(et,2),M=he[0],ge=he[1],tt=(0,_.useState)([]),Ce=(0,s.Z)(tt,2),i=Ce[0],ue=Ce[1],at=(0,_.useState)([]),ye=(0,s.Z)(at,2),nt=ye[0],j=ye[1],lt=(0,_.useState)(!1),Be=(0,s.Z)(lt,2),_t=Be[0],pe=Be[1],rt=(0,_.useState)(""),Ae=(0,s.Z)(rt,2),Le=Ae[0],st=Ae[1],ot=(0,_.useState)(),Ze=(0,s.Z)(ot,2),ut=Ze[0],Et=Ze[1],te=(0,_.useRef)(),it=(0,_.useState)(!1),Se=(0,s.Z)(it,2),ct=Se[0],Ie=Se[1],dt=(0,_.useState)(""),Te=(0,s.Z)(dt,2),mt=Te[0],vt=Te[1],Dt=(0,_.useState)(!1),Ke=(0,s.Z)(Dt,2),ae=Ke[0],Z=Ke[1],N=(0,_.useRef)(null),Pt=(0,_.useState)(!1),Re=(0,s.Z)(Pt,2),Mt=Re[0],We=Re[1],Ot=(0,_.useState)(),Fe=(0,s.Z)(Ot,2),u=Fe[0],Ue=Fe[1],ft=(0,_.useState)([]),xe=(0,s.Z)(ft,2),ht=xe[0],Ee=xe[1],gt=()=>{pe(!0),h.W.get("".concat(v.Z.apiPrefix,"scripts")).then(a=>{ue(a.data),j(a.data),Ct()}).finally(()=>pe(!1))},Ve=a=>{h.W.get("".concat(v.Z.apiPrefix,"scripts/").concat(a.value,"?path=").concat(a.parent||"")).then(n=>{L(n.data)})},Ct=()=>{var a=oe.m.location.query,n=a.p,l=a.s;if(l){var r="".concat(n,"/").concat(l),S={node:{title:l,value:l,key:n?r:l,parent:n}};Ee([n]),be([r],S)}},ne=(a,n)=>{if(!(n.key===M||!a)){L("\u52A0\u8F7D\u4E2D...");var l=a?Xe[a.slice(-3)]:"";st(P&&l==="typescript"?"javascript":l),ge(n.key),Oe(n.key),Ue(n),Ve(n)}},yt=a=>{Ee(a)},be=(0,_.useCallback)((a,n)=>{var l=N.current?N.current.getValue().replace(/\r\n/g,`
`):B;l!==B?W.Z.confirm({title:"\u786E\u8BA4\u79BB\u5F00",content:t().createElement(t().Fragment,null,"\u5F53\u524D\u4FEE\u6539\u672A\u4FDD\u5B58\uFF0C\u786E\u5B9A\u79BB\u5F00\u5417"),onOk(){ne(a[0],n.node),Z(!1)},onCancel(){console.log("Cancel")}}):(Z(!1),ne(a[0],n.node))},[B]),Bt=(0,_.useCallback)(a=>{var n=a.target.value;pt(n)},[i,j]),pt=(0,_.useCallback)(w()(a=>{vt(a);var n=Me(a.toLocaleLowerCase(),i),l=n.tree,r=n.expandedKeys;Ee(r),j(l)},300),[i,j]),ke=()=>{setTimeout(()=>{Z(!0)},300)},je=()=>{Z(!1),L("\u52A0\u8F7D\u4E2D..."),Ve(u)},Ne=()=>{W.Z.confirm({title:"\u786E\u8BA4\u4FDD\u5B58",content:t().createElement(t().Fragment,null,"\u786E\u8BA4\u4FDD\u5B58\u6587\u4EF6",t().createElement(q,{style:{wordBreak:"break-all"},type:"warning"},u.value)," ","\uFF0C\u4FDD\u5B58\u540E\u4E0D\u53EF\u6062\u590D"),onOk(){var a=N.current?N.current.getValue().replace(/\r\n/g,`
`):B;return new Promise((n,l)=>{h.W.put("".concat(v.Z.apiPrefix,"scripts"),{data:{filename:u.value,path:u.parent||"",content:a}}).then(r=>{r.code===200?(p.ZP.success("\u4FDD\u5B58\u6210\u529F"),L(a),Z(!1)):p.ZP.error(r),n(null)}).catch(r=>l(r))})},onCancel(){console.log("Cancel")}})},ze=()=>{W.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:t().createElement(t().Fragment,null,"\u786E\u8BA4\u5220\u9664\u6587\u4EF6",t().createElement(q,{style:{wordBreak:"break-all"},type:"warning"},M)," ","\uFF0C\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D"),onOk(){h.W.delete("".concat(v.Z.apiPrefix,"scripts"),{data:{filename:u.value,path:u.parent||""}}).then(a=>{if(a.code===200){p.ZP.success("\u5220\u9664\u6210\u529F");var n=[...i];if(u.parent){var l=n.findIndex(c=>c.key===u.parent),r=n[l],S=r.children.findIndex(c=>c.key===u.key);S!==-1&&l!==-1&&(r.children.splice(S,1),n.splice(l,1,(0,f.Z)({},r)))}else{var O=n.findIndex(c=>c.key===u.key);O!==-1&&n.splice(O,1)}ue(n)}else p.ZP.error(a)})},onCancel(){console.log("Cancel")}})},Ge=()=>{We(!0)},At=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{filename:"",path:"",key:""},l=n.filename,r=n.path,S=n.key;if(l){var O=[...i],c={title:l,key:S,value:l,parent:r};if(r){var ie=O.findIndex(It=>It.key===r);if(ie!==-1){var z=O[ie];z.children&&z.children.length>0?z.children.unshift(c):z.children=[c],O.splice(ie,1,(0,f.Z)({},z))}}else O.unshift(c);ue(O),ne(c.value,c),Z(!0)}We(!1)},Tt=()=>{h.W.post("".concat(v.Z.apiPrefix,"scripts/download"),{data:{filename:u.value}}).then(a=>{var n=new Blob([a],{type:"application/json"}),l=URL.createObjectURL(n),r=document.createElement("a");r.href=l,r.download=u.value,document.documentElement.appendChild(r),r.click(),document.documentElement.removeChild(r)})};(0,_.useEffect)(()=>{var a=mt||"",n=Me(a.toLocaleLowerCase(),i),l=n.tree;j(l),ge(""),Ue(null),Oe("\u8BF7\u9009\u62E9\u811A\u672C\u6587\u4EF6"),L("\u8BF7\u9009\u62E9\u811A\u672C\u6587\u4EF6")},[i]),(0,_.useEffect)(()=>{gt(),te&&te.current&&Et(te.current.clientHeight)},[]);var Lt=a=>{switch(a){case"save":Ne();break;case"exit":je();break;default:break}},Zt=a=>{switch(a){case"save":Ge();break;case"edit":ke();break;case"delete":ze();break;default:break}},St=ae?t().createElement(m.Z,{items:[{label:"\u4FDD\u5B58",key:"save",icon:t().createElement(U.Z,null)},{label:"\u9000\u51FA\u7F16\u8F91",key:"exit",icon:t().createElement(o.Z,null)}],onClick:a=>{var n=a.key,l=a.domEvent;l.stopPropagation(),Lt(n)}}):t().createElement(m.Z,{items:[{label:"\u65B0\u5EFA",key:"add",icon:t().createElement(U.Z,null)},{label:"\u7F16\u8F91",key:"edit",icon:t().createElement(o.Z,null),disabled:!M},{label:"\u5220\u9664",key:"delete",icon:t().createElement(C.Z,null),disabled:!M}],onClick:a=>{var n=a.key,l=a.domEvent;l.stopPropagation(),Zt(n)}});return t().createElement(re.ZP,{className:"ql-container-wrapper log-wrapper",title:we,loading:_t,extra:P?[t().createElement(J.Z,{className:"log-select",value:M,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:i,placeholder:"\u8BF7\u9009\u62E9\u811A\u672C",showSearch:!0,onSelect:ne}),t().createElement(K.Z,{overlay:St,trigger:["click"]},t().createElement(d.Z,{type:"primary",icon:t().createElement(E.Z,null)}))]:ae?[t().createElement(d.Z,{type:"primary",onClick:Ne},"\u4FDD\u5B58"),t().createElement(d.Z,{type:"primary",onClick:je},"\u9000\u51FA\u7F16\u8F91")]:[t().createElement($.Z,{title:"\u65B0\u5EFA"},t().createElement(d.Z,{type:"primary",onClick:Ge,icon:t().createElement(U.Z,null)})),t().createElement($.Z,{title:"\u7F16\u8F91"},t().createElement(d.Z,{disabled:!M,type:"primary",onClick:ke,icon:t().createElement(o.Z,null)})),t().createElement($.Z,{title:"\u5220\u9664"},t().createElement(d.Z,{type:"primary",disabled:!M,onClick:ze,icon:t().createElement(C.Z,null)})),t().createElement(d.Z,{type:"primary",onClick:()=>{Ie(!0)}},"\u8C03\u8BD5")],header:{style:ee}},t().createElement("div",{className:"".concat(g()["log-container"]," log-container")},!P&&t().createElement(se.Z,{split:"vertical",size:200,maxSize:-100},t().createElement("div",{className:g()["left-tree-container"]},i.length>0?t().createElement(t().Fragment,null,t().createElement(H.Z.Search,{className:g()["left-tree-search"],onChange:Bt,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u540D",allowClear:!0}),t().createElement("div",{className:g()["left-tree-scroller"],ref:te},t().createElement(_e.Z,{className:g()["left-tree"],treeData:nt,showIcon:!0,height:ut,selectedKeys:[M],expandedKeys:ht,onExpand:yt,showLine:{showLeafIcon:!0},onSelect:be}))):t().createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}},t().createElement(G.Z,{description:"\u6682\u65E0\u811A\u672C",image:G.Z.PRESENTED_IMAGE_SIMPLE}))),t().createElement(X.ZP,{language:Le,value:B,theme:V,options:{readOnly:!ae,fontSize:12,lineNumbersMinChars:3,folding:!1,glyphMargin:!1},onMount:a=>{N.current=a}})),P&&t().createElement(A.fk,{value:B,options:{lineNumbers:!0,lineWrapping:!0,styleActiveLine:!0,matchBrackets:!0,mode:Le,readOnly:!ae},onBeforeChange:(a,n,l)=>{L(l)},onChange:(a,n,l)=>{}}),t().createElement(Y.default,{visible:ct,treeData:i,currentNode:u,content:B,socketMessage:y,handleCancel:()=>{Ie(!1)}}),t().createElement(Pe.default,{visible:Mt,treeData:i,handleCancel:At})))};I.default=Ye}}]);
